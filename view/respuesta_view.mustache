{{> header}}
<div class="flex flex-col justify-center items-center justify-items-center">
    <div class="partida">

        <div class="pregunta-container cuadro text-center">
            {{#pregunta}}
                <p>{{pregunta}}</p>
            {{/pregunta}}

            {{#preguntaId}}
                <p style="display: none;" id="idPregunta">{{preguntaId}}</p>
            {{/preguntaId}}
            {{#usuarioId}}
                <p style="display: none;" id="idUsuario">{{usuarioId}}</p>
            {{/usuarioId}}

            {{#correcto}}
                <p>Respuesta Correcta </p>
            {{/correcto}}
        </div>

        <div class="pregunta-container cuadro text-center">
            {{#mensaje}}
                <p>{{mensaje}}</p>
            {{/mensaje}}
        </div>

        <div class="pregunta-container cuadro text-center">
            {{#puntaje}}
                <p>Puntaje: {{puntaje}}</p>
            {{/puntaje}}
        </div>


        <a href="{{url}}" class="bg-yellow-500 border border-back text-black rounded p-2">{{texto}}</a>


    </div>
</div>
<button id="btn-reportar-pregunta" onclick="mostrarPopup()">Reportar Pregunta</button>
<div id="popup-reporte" style="display: none;">
    <h2>¿Por qué quieres reportar la pregunta?</h2>
    <textarea id="motivo-reportar" rows="4" cols="50"></textarea>
    <button onclick="enviarReporte()">Enviar Reporte</button>
</div>
<script>
    function mostrarPopup() {
        var popup = document.getElementById("popup-reporte");
        popup.style.display = "block";
    }

    function enviarReporte() {
        var motivo = document.getElementById("motivo-reportar").value;
        var idUsuario = document.getElementById("idUsuario").innerHTML;
        var idPregunta = document.getElementById("idPregunta").innerHTML;

        if (motivo.trim() === '') {
            alert('Por favor, ingresa un motivo para reportar la pregunta.');
            return;
        }

        var data = {
            motivo: motivo,
            idUsuario: idUsuario,
            idPregunta: idPregunta
        };

        var requestOptions = {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        };
        var url = 'http://localhost:80/partida/reportarPregunta';

        fetch(url, requestOptions)
                .then(response => {
                    if (response.ok) {
                        console.log(motivo);
                        console.log(idUsuario);
                        console.log(idPregunta);
                        window.location.href = '/lobby/list';
                    } else {
                        console.log('Hubo un error al enviar el reporte.');
                    }
                })
                .catch(error => {
                    console.log('Hubo un error en la solicitud AJAX:', error);
                });
    }
    setTimeout(function() {
        window.location.href = "{{url}}";
    }, 30000);
</script>
</body>
{{>footer}}